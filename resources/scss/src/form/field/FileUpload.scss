.neo-file-upload-field {
    background-color : v(fileuploadfield-background-color);
    border-color     : v(fileuploadfield-border-color);
    color            : v(fileuploadfield-color);
}

.neo-file-upload-field {
    --upload-icon-codepoint : "\f062";
    --cancel-icon-codepoint : "\f00d";
    --delete-icon-codepoint : "\f1f8";

    min-height : 3.5rem;
    position   : relative;
    display    : flex;
    padding    : 0.5rem;
    gap        : 0.5rem;
    border     : 1px solid;

    // Space for any error message
    margin-bottom : 2rem;

    // Icons
    i, button {
        font-style      : normal;
        flex            : 0 0 2rem;
        height          : 2rem;
        border-radius   : 50%;
        font-family     : var(--fa-style-family,"Font Awesome 6 Free");
        display         : flex;
        align-items     : center;
        justify-content : center;
        border          : 0 none;
        background      : transparent;
        color           : inherit;

        &::after {
            background-color : var(--fileuploadfield-background-color);
            font-weight      : var(--fa-style, 900);
            display          : flex;
            align-items      : center;
            justify-content  : center;
            aspect-ratio     : 1;
            border-radius    : 50%;
        }
    }

    .neo-file-upload-filename {
        font-weight   : bold;
        white-space   : nowrap;
        overflow      : hidden;
        text-overflow : ellipsis;
    }

    // The file input is only visible in the ready state
    &:not(.neo-file-upload-state-ready) {
        input[type="file"] {
            display : none;
        }
    }

    &.neo-invalid {
        .neo-file-upload-error-message {
            display : initial;
        }
    }
}

// During upload, it's a progress circle
.neo-file-upload-state-uploading {
    .neo-file-upload-state-icon {
        background-image : conic-gradient(
            var(--fileuploadfield-progress-color) 0 var(--upload-progress),
            transparent var(--upload-progress) 1turn
        );

        &::after {
            content          : var(--upload-icon-codepoint);
            flex             : 0 0 calc(100% - 6px);
        }
    }
}

.neo-file-upload-state-processing {
    .neo-file-upload-state-icon {
        background-image : conic-gradient(
            from 0deg, transparent 0deg,
            var(--fileuploadfield-progress-color) 180deg,
            transparent 180deg
        );
        animation: spinner-rotation 3s linear infinite;

        &::after {
            content : "";
            flex    : 0 0 calc(100% - 6px);
        }
    }
}

// While uploading and scanning, we can abort the whole upload/scan process
.neo-file-upload-state-processing, .neo-file-upload-state-processing {
    .neo-file-upload-action-button {
        // Invitation to click
        cursor : pointer;

        &::after {
            content          : var(--cancel-icon-codepoint);
            flex             : 0 0 calc(100% - 6px);
        }
    }
}

.neo-file-upload-state-ready {
    // Only the input field is visible when in ready state
    // It takes up the whole component, and is the only interactive item
    :not(input[type="file"]) {
        display : none;
    }
    input::file-selector-button {
        position         : absolute;
        border           : 0 none;
        margin           : 0;
        top              : 0;
        left             : 0;
        right            : 0;
        bottom           : 0;
        background-color : var(--fileuploadfield-background-color);
        color            : var(--fileuploadfield-color);
    }
}

.neo-file-upload-body {
    flex        : 1 1 0%;
    display     : flex;
    flex-flow   : column nowrap;
    line-height : 1;
    gap         : 0.2rem;
    overflow    : hidden;
}

.neo-file-upload-error-message {
    display            : none;
    position           : absolute;
    inset-inline-start : 0;
    white-space        : nowrap;
    top                : 100%;
    padding            : 0.5rem;
    color              : red;
}

@keyframes spinner-rotation {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
}
